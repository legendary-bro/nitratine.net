<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="icon" href="/assets/img/favicon.ico">
        <link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon"><meta name="theme-color" content="#343a40"><link rel="canonical" href="https://nitratine.net/blog/post/how-to-hash-files-in-python/">

        <!-- Bootstrap core CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy" crossorigin="anonymous">
        <link rel="stylesheet" href="/assets/css/base.css">
        <link rel="stylesheet" href="/assets/css/custom-bootstrap.css"><!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117153268-2"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'UA-117153268-2');
        </script><!-- instant.page -->
        <script defer src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>

        
        <title>How to Hash Files in Python - Nitratine</title>
        <link rel="stylesheet" href="/assets/css/blog.css">
        <link rel="stylesheet" href="/assets/css/pygments.css">

        <meta name="description" content="Hashing files allows us to generate a string/byte sequence that can help identify a file. This can then be used by comparing the hashes of two or more files to see if these files are the same as well as other applications.">
        <meta name="author" content="Brent Vollebregt">
        <meta property="og:title" content="How to Hash Files in Python">
        <meta property="og:description" content="Hashing files allows us to generate a string/byte sequence that can help identify a file. This can then be used by comparing the hashes of two or more files to see if these files are the same as well as other applications.">
        <meta property="og:image" content="/post-assets/how-to-hash-files-in-python/feature.png">
        <meta property="og:url" content="https://nitratine.net/blog/post/how-to-hash-files-in-python/">
        <meta name="twitter:card" content="summary"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({
                      google_ad_client: "ca-pub-6407227183932047",
                      enable_page_level_ads: true
                 });
            </script>
    </head>

    <body>
        <!-- Navigation -->
        <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
            <div class="container">
                <a class="navbar-brand" href="/">
                    <img src="/assets/img/logo.png" width="145" height="30" class="d-inline-block align-top" alt="Brand Icon">
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-between" id="navbar">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item ">
                            <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item ">
                            <a class="nav-link" href="/blog/">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.youtube.com/PyTutorials">YouTube</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://github.com/brentvollebregt">GitHub</a>
                        </li>
                        <li class="nav-item ">
                            <a class="nav-link" href="/about/">About</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main role="main" class="container">

            
            <div class="row">
                <div class="col-blog-content blog-main">

                    <h1 class="blog-post-title">How to Hash Files in Python</h1>
                    <p class="text-muted">
                        <a href="/blog/archive/#2019" class="text-muted">07 May 2019</a>
                        <a href="/blog/categories/#Tutorials" class="badge badge-primary ml-2">Tutorials</a>
                        
                        <a href="/blog/tags/#python" class="badge badge-warning">python</a>
                        
                        <img src="https://hitcounter.pythonanywhere.com/count/tag.svg" alt="Hits" class="post-hits">
                    </p>
                    <p class="lead">Hashing files allows us to generate a string/byte sequence that can help identify a file. This can then be used by comparing the hashes of two or more files to see if these files are the same as well as other applications.</p>
                    <hr>

                    <div class="post-content">
                        <div class="toc">
<ul>
<li><a href="#what-does-it-mean-to-hash-a-file">What Does it Mean to Hash a File?</a><ul>
<li><a href="#what-can-i-do-with-a-file-hash">What Can I Do With A File Hash?</a><ul>
<li><a href="#what-can-i-not-do-with-a-file-hash">What Can I Not Do With A File Hash?</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#supported-hashing-algorithms-in-python">Supported Hashing Algorithms in Python</a><ul>
<li><a href="#hashlibalgorithms_guaranteed-vs-hashlibalgorithms_available">hashlib.algorithms_guaranteed vs hashlib.algorithms_available</a></li>
</ul>
</li>
<li><a href="#hashing-a-file">Hashing a File</a><ul>
<li><a href="#why-do-i-need-to-worry-about-the-buffer-size">Why do I Need to Worry About the Buffer Size?</a></li>
</ul>
</li>
</ul>
</div>
<blockquote>
<p>Note: This post assumes you already know what a hash is, if you don't, read up on hashes before reading this post. Sites like <a href="https://cs.stackexchange.com/a/55472">this</a> or <a href="https://stackoverflow.com/a/506035">this</a> can help you out. </p>
</blockquote>
<h2 id="what-does-it-mean-to-hash-a-file">What Does it Mean to Hash a File?</h2>
<p>Hashing a file is when a file of arbitrary size is read and used in a function to compute a fixed-length value from it. This fixed length value can help us get a sort of 'id' of a file which can then help us do particular tasks (examples follow).</p>
<p>Strong hashes with large amounts of bytes can help distinguish between many different files, but we do always need to remember the <a href="https://en.wikipedia.org/wiki/Birthday_problem">birthday problem</a>. For example, the birthday problem reminds us that if we have a 160bit hash, there can only be 2^160 different hashes, meaning that as soon as we generate 2^160 + 1 hashes of different files, it is guaranteed that we find a duplicate hash. This duplicate hash means we get the same hash for different files which can cause issues in some applications.</p>
<h3 id="what-can-i-do-with-a-file-hash">What Can I Do With A File Hash?</h3>
<p>File hashes are quite useful as they can represent (not substitute) a file, meaning that you do not have to store the whole file when trying to identify a file. When hashing files (or anything in general), you will get the same result hash result every time you hash a particular file. This makes hashing files useful for things like:</p>
<ul>
<li><strong>Comparing files</strong>: Instead of comparing whole files, take hashes and compare hashes together. This is particularly efficient when comparing more than one file to another file.</li>
<li><strong>Easily identifying files without storing the whole file</strong>: If you are looking for a file, simply get the hash of your current file and hash other files as you look at them while looking for a match. This technique is used by some anti-virus software.</li>
<li><strong>Stopping filename clashes</strong>: Rename files where many files are located in one directory to their hash. This will mean two different files will not have the same name and will save on space when two files have the same name as they will overwrite (does not work if you need two of the same file).</li>
<li><strong>Object keys</strong>: Just like in the point "Stopping filename clashes", using hashes as object keys can help identify what objects match to which file.</li>
<li><strong>Detecting changes in a file</strong>: If you had a file hash before it was modified, you can re-hash the file and compare it against the original hash to see if it has been modified.</li>
</ul>
<h4 id="what-can-i-not-do-with-a-file-hash">What Can I Not Do With A File Hash?</h4>
<p>Even though you can compute a hash using a file, this does not mean you cannot get the original file back using this hash. Hashing is a one way function (lossy) and is not an encryption scheme.</p>
<h2 id="supported-hashing-algorithms-in-python">Supported Hashing Algorithms in Python</h2>
<p>The <a href="https://docs.python.org/3/library/hashlib.html"><code>hashlib</code> Python module</a> <em>"implements a common interface to many different secure hash and message digest algorithms"</em>. To look at the hashing algorithms Python offers, execute:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="k">print</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">algorithms_guaranteed</span><span class="p">)</span>
</pre></div>


<p>This will print a set of strings that are hash algorithms guaranteed to be supported by this module on all platforms. To use these, select a hashing algorithm from the set and then use it as shown below (this example uses sha256):</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">()</span> <span class="c1"># Construct a hash object using our selected hashing algorithm</span>
<span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;My content&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span> <span class="c1"># Upade the hash using a bytes object</span>
<span class="k">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span> <span class="c1"># Print the hash value as a hex string</span>
<span class="k">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span> <span class="c1"># Print the hash value as a bytes object</span>
</pre></div>


<h3 id="hashlibalgorithms_guaranteed-vs-hashlibalgorithms_available">hashlib.algorithms_guaranteed vs hashlib.algorithms_available</h3>
<p>To get all the algorithms available in your interpreter, you can execute <code>hashlib.algorithms_available</code>. Unlike the output from <code>hashlib.algorithms_guaranteed</code>, these hashes aren't guaranteed to exist in interpreters on other machines. You can <a href="https://docs.python.org/3/library/hashlib.html#hashlib.algorithms_guaranteed">visit the docs</a> to get more information on this.</p>
<h2 id="hashing-a-file">Hashing a File</h2>
<p>To hash a file, read it in bit-by-bit and update the current hashing functions instance. When all bytes have been given to the hashing function in order, we can then get the hex digest.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span>

<span class="nb">file</span> <span class="o">=</span> <span class="s2">&quot;.\myfile.txt&quot;</span> <span class="c1"># Location of the file (can be set a different way)</span>
<span class="n">BLOCK_SIZE</span> <span class="o">=</span> <span class="mi">65536</span> <span class="c1"># The size of each read from the file</span>

<span class="n">file_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">()</span> <span class="c1"># Create the hash object, can use something other than `.sha256()` if you wish</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="c1"># Open the file to read it&#39;s bytes</span>
    <span class="n">fb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">BLOCK_SIZE</span><span class="p">)</span> <span class="c1"># Read from the file. Take in the amount declared above</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># While there is still data being read from the file</span>
        <span class="n">file_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span> <span class="c1"># Update the hash</span>
        <span class="n">fb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">BLOCK_SIZE</span><span class="p">)</span> <span class="c1"># Read the next block from the file</span>

<span class="k">print</span> <span class="p">(</span><span class="n">file_hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span> <span class="c1"># Get the hexadecimal digest of the hash</span>
</pre></div>


<p>This snippet will print the hash value of the file specified in <code>file</code> generated using the SHA256 algorithm. The call <code>.hexdigest()</code> returns a string object containing only hexadecimal digits; you can use <code>.digest()</code> as shown before to get the bytes representation of the hash.</p>
<h3 id="why-do-i-need-to-worry-about-the-buffer-size">Why do I Need to Worry About the Buffer Size?</h3>
<p>You would have noticed in the script above, the variable <code>BLOCK_SIZE</code> is set to <code>65536</code>. This is the amount of bytes that is read into memory in a single read operation. This is used so larger files are not completely loaded into memory before computing the hash. </p>
<p>For example, if we did not do this and were hashing a video file that was 2Gb large, the whole 2Gb file would be loaded into memory (or at least tried to) and then hashed. This approach reads the file block-by-block so we don't load the whole file into memory.</p>
<p>The buffer I have used is 64Kb but you can use any value you wish. Making this larger reads files faster, but in turn loads more of the file into memory at once.</p>
                    </div>

                    <nav class="blog-pagination text-center mb-5 mt-4">
                        
                            <a class="btn btn-outline-primary mt-1" href="/blog/post/google-publisher-toolbar-please-copy-this-code/">&larr; Google Publisher Toolbar: P...</a>
                        
                        
                            <a class="btn btn-outline-primary mt-1" href="/blog/post/javascript-date-methods-return-values/">JavaScript Date Methods Ret... &rarr;</a>
                        
                    </nav>

                    
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function() {
                            this.page.url = 'https://nitratine.net/blog/post/how-to-hash-files-in-python/'; // Your page's canonical URL variable
                            this.page.identifier = 'https://nitratine.net/blog/post/how-to-hash-files-in-python/'; // Your page's unique identifier variable
                        };
                        (function() {
                            var d = document,
                                s = d.createElement('script');
                            s.src = '//nitratine.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                    

                </div>

                                <!-- Sidebar -->
                <aside class="col-blog-sidebar blog-sidebar">

                    <div class="card p-3 mb-3 bg-light">
                        <h4 class="text-center text-lg-left">About</h4>
                        <p class="mb-0">Owner of <a href="https://www.youtube.com/PyTutorials">PyTurorials</a> and creator of <a href="https://github.com/brentvollebregt/auto-py-to-exe">auto-py-to-exe</a>. I enjoy making quick tutorials for people new to particular topics in Python and  tools that help fix small things.</p>
                    </div>

                    <div class="input-group mb-3">
                      <input id="search" type="text" class="form-control" placeholder="Search" aria-label="Search">
                        <div class="input-group-append">
                            <button id="search-submit" class="btn btn-outline-primary" type="button">Search</button>
                        </div>
                    </div>
                    <script>let searchUrl = "/search/";</script>
                    <script type="text/javascript" defer src="/assets/js/search.js"></script>

                    <div class="card p-3 mb-3 bg-light">
                        <h4 class="text-center text-lg-left">Categories</h4>
                        <ol class="list-unstyled mb-0 text-center text-lg-left">
                            
                                <li>
                                <a href="/blog/categories/#Apps">&#x1F4F1; Apps
                                    <span class="badge badge-primary ml-3">2</span>
                                </a>
                            </li>
                            
                                <li>
                                <a href="/blog/categories/#General">&#x1F4F0; General
                                    <span class="badge badge-primary ml-3">6</span>
                                </a>
                            </li>
                            
                                <li>
                                <a href="/blog/categories/#Investigations">&#x1F50D; Investigations
                                    <span class="badge badge-primary ml-3">2</span>
                                </a>
                            </li>
                            
                                <li>
                                <a href="/blog/categories/#Projects">&#x1F4BE; Projects
                                    <span class="badge badge-primary ml-3">13</span>
                                </a>
                            </li>
                            
                                <li>
                                <a href="/blog/categories/#Tutorials">&#x1F4D6; Tutorials
                                    <span class="badge badge-primary ml-3">12</span>
                                </a>
                            </li>
                            
                                <li>
                                <a href="/blog/categories/#YouTube">&#x1F3A5; YouTube
                                    <span class="badge badge-primary ml-3">15</span>
                                </a>
                            </li>
                            
                        </ol>
                    </div>

                    <div class="card p-3 mb-3 bg-light">
                        <h4 class="text-center text-lg-left">PyTutorials on YouTube</h4>
                        <script src="https://apis.google.com/js/platform.js"></script>
                        <div style="text-align: center">
                            <div class="g-ytsubscribe" data-channel="PrivateSplat" data-layout="full" data-count="default"></div>
                        </div>
                    </div>

                    <div class="card p-3 mb-3 bg-light">
                        <h4 class="text-center text-lg-left">Recent Videos</h4>
                        <div id="recent-yt-videos" class="yt_video_container"></div>
                    </div>

                    <script>
                        let youtube_data_api_key = 'AIzaSyDz6QJ7H1Ca575XwvKnO8Q4MVATUxLdHYM';
                        let youtube_channel_id = 'UCesEknt3SRX9R9W_f93Tb7g';
                    </script>
                    <script type="text/javascript" defer src="/assets/js/getRecentYouTubeVideos.js"></script>

                </aside>

            </div>


        </main>

        <!-- Bootstrap -->
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    </body>
</html>